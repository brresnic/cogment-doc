
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Cogment user documentation - Cogment is an innovative open source AI platform designed to leverage the advent of AI to benefit humankind through human-AI collaboration">
      
      
      
        <meta name="author" content="AI Redefined">
      
      
        <link rel="canonical" href="https://docs.cogment.ai/cogment/tutorial/2-random-player/">
      
      <link rel="icon" href="../../../images/cogment_favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.5">
    
    
      
        <title>Step 2: Implement actor and environment - Cogment</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../style/theme.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-146998765-2","doc.cogment.ai"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-2-implement-a-first-actor-and-environment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Cogment" class="md-header__button md-logo" aria-label="Cogment" data-md-component="logo">
      
  <img src="../../../images/cogment_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cogment
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Step 2: Implement actor and environment
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/cogment/cogment-doc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Cogment" class="md-nav__button md-logo" aria-label="Cogment" data-md-component="logo">
      
  <img src="../../../images/cogment_logo.png" alt="logo">

    </a>
    Cogment
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/cogment/cogment-doc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Introduction
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Introduction" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../introduction/installation/" class="md-nav__link">
        Installation & Setup
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Support
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Support" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Support
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../support/community-channels/" class="md-nav__link">
        Community channels
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Concepts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Concepts" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/core-concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Cogment
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cogment" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Cogment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" checked>
      
      <label class="md-nav__link" for="__nav_4_1">
        Tutorial
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorial" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../1-bootstrap-and-data-structures/" class="md-nav__link">
        Step 1: Bootstrap a Cogment app
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Step 2: Implement actor and environment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Step 2: Implement actor and environment
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-2-implement-a-first-actor-and-environment" class="md-nav__link">
    Step 2: Implement a first actor and environment
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Implement a first actor and environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random-player-agent" class="md-nav__link">
    Random player agent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-the-rules-of-the-game" class="md-nav__link">
    Implementing the rules of the game
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../3-rewards/" class="md-nav__link">
        Step 3: Introduce rewards
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../4-heuristic-player/" class="md-nav__link">
        Step 4: Create a heuristic player
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../5-human-player/" class="md-nav__link">
        Step 5: Add a human player in the loop
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../6-web-client/" class="md-nav__link">
        Step 6: Implement a web client for the human player
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../7-dqn-player/" class="md-nav__link">
        Step 7: Add a player trained with Reinforcement Learning using DQN
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-guide/" class="md-nav__link">
        API Guide
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      <label class="md-nav__link" for="__nav_4_3">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/cogment-yaml/" class="md-nav__link">
        cogment.yaml
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/python/" class="md-nav__link">
        python
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3" type="checkbox" id="__nav_4_3_3" >
      
      <label class="md-nav__link" for="__nav_4_3_3">
        Javascript/Typescript SDK
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Javascript/Typescript SDK" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_3">
          <span class="md-nav__icon md-icon"></span>
          Javascript/Typescript SDK
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/modules/" class="md-nav__link">
        Modules
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/classes/actorsession/" class="md-nav__link">
        Class: ActorSession
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/classes/cogmentservice/" class="md-nav__link">
        Class: CogmentService
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/classes/trialcontroller/" class="md-nav__link">
        Class: TrialController
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/enums/eventtype/" class="md-nav__link">
        Enum: EventType
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/cogmentyaml/" class="md-nav__link">
        Interface: CogmentYaml
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/cogmentyamlactor/" class="md-nav__link">
        Interface: CogmentYamlActor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/cogmentyamlactorclass/" class="md-nav__link">
        Interface: CogmentYamlActorClass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/cogmentyamldatalog/" class="md-nav__link">
        Interface: CogmentYamlDatalog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/cogmentyamltrialparameters/" class="md-nav__link">
        Interface: CogmentYamlTrialParameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/cogsettings/" class="md-nav__link">
        Interface: CogSettings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/cogsettingsactorclass/" class="md-nav__link">
        Interface: CogSettingsActorClass
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/createserviceoptions/" class="md-nav__link">
        Interface: CreateServiceOptions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/event/" class="md-nav__link">
        Interface: Event
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/reward/" class="md-nav__link">
        Interface: Reward
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/sendmessageoptions/" class="md-nav__link">
        Interface: SendMessageOptions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-api-reference/javascript/interfaces/trialactor/" class="md-nav__link">
        Interface: TrialActor
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      <label class="md-nav__link" for="__nav_4_4">
        Low Level API Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Low Level API Guide" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Low Level API Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-low-level-api-guide/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-low-level-api-guide/grpc/" class="md-nav__link">
        gRPC API Reference
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../dashboard/metrics-and-dashboard/" class="md-nav__link">
        Metrics & Dashboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-2-implement-a-first-actor-and-environment" class="md-nav__link">
    Step 2: Implement a first actor and environment
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Implement a first actor and environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random-player-agent" class="md-nav__link">
    Random player agent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-the-rules-of-the-game" class="md-nav__link">
    Implementing the rules of the game
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cogment/cogment-doc/edit/main/src/cogment/tutorial/2-random-player.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Step 2: Implement actor and environment</h1>
                
                <h2 id="step-2-implement-a-first-actor-and-environment">Step 2: Implement a first actor and environment<a class="headerlink" href="#step-2-implement-a-first-actor-and-environment" title="Permanent link">&para;</a></h2>
<blockquote>
<p>This part of the tutorial follows <a href="../1-bootstrap-and-data-structures/">step 1</a>, make sure you've gone through it before starting this one. Alternatively, the completed step 1 can be retrieved from the <a href="https://github.com/cogment/cogment-tutorial-rps" target="_blank">tutorial's repository</a>.</p>
</blockquote>
<p>In this step of the tutorial, we will implement the (very simple) decison logic for the random player as well as the base mechanics for RPS, i.e. the rules of the game, in the environment services.</p>
<h3 id="random-player-agent">Random player agent<a class="headerlink" href="#random-player-agent" title="Permanent link">&para;</a></h3>
<p>In the <code>rps</code> directory, the <code>random_agent</code> directory contains the python implementation for the eponymous service. You'll find two files here:</p>
<ul>
<li><code>requirements.txt</code> is a <a href="https://pip.pypa.io/en/stable/reference/pip_install/?highlight=requirements#requirements-file-format" target="_blank">pip requirement file</a> defining the dependencies of the service. For the moment it only lists <a href="https://pypi.org/project/cogment/" target="_blank"><code>cogment</code></a>, Cogment's python SDK.</li>
<li><code>main.py</code> contains the implementation of the service.</li>
</ul>
<p>Open <code>main.py</code> and take a look at the generated content.</p>
<p>At the bottom you'll find the <code>main</code> function, it initializes Cogment's context, registers the <code>random_agent</code> actor's implementation, then starts the service itsef on tcp port 9000 and awaits its termination.</p>
<blockquote>
<p>Cogment's python sdk leverages Python's <a href="https://docs.python.org/3/library/asyncio-task.html" target="_blank">asynchronous features</a>, you'll need a basic understanding of them.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Random-Agent actor service up and running.&quot;</span><span class="p">)</span>

  <span class="n">context</span> <span class="o">=</span> <span class="n">cogment</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span><span class="n">cog_settings</span><span class="o">=</span><span class="n">cog_settings</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="s2">&quot;rps&quot;</span><span class="p">)</span>
  <span class="n">context</span><span class="o">.</span><span class="n">register_actor</span><span class="p">(</span>
      <span class="n">impl</span><span class="o">=</span><span class="n">random_agent</span><span class="p">,</span>
      <span class="n">impl_name</span><span class="o">=</span><span class="s2">&quot;random_agent&quot;</span><span class="p">,</span>
      <span class="n">actor_classes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;player&quot;</span><span class="p">,])</span>

  <span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">serve_all_registered</span><span class="p">(</span><span class="n">cogment</span><span class="o">.</span><span class="n">ServedEndpoint</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">9000</span><span class="p">))</span>
</code></pre></div>

<p>At the beginning of the file, the function <code>random_agent</code> is the actor's implementation. This function is called once per actor and per trial and handles the full lifetime of the actor.</p>
<ul>
<li>The actor's <strong>initialization</strong>, before the <code>async for</code>. This is where, for example, actor's internal data can be defined before calling <code>actor_session.start()</code> to notify that it is ready,</li>
<li>Its <strong>event loop</strong>, the content of the <code>async for</code>. This is where resides the implementation of the actor's response to various events,</li>
<li>Its <strong>termination</strong>, after the <code>async for</code>.</li>
</ul>
<p>The generated implementation is very simple:</p>
<ul>
<li>it handles the three main kind of events: <strong>observations</strong>, <strong>rewards</strong> and <strong>messages</strong>,</li>
<li>it does a default <strong>action</strong> whenever required, i.e. in response to an observation.</li>
</ul>
<p>We will further learn about how to use rewards in <a href="../3-rewards/">step 3</a> and observations in <a href="../4-heuristic-player/">step 4</a>. Messages are out of the scope for this <em>basics</em> tutorial.</p>
<p>Please note the import and usage of <code>PlayerAction</code> which is the data structure from <code>data.proto</code> defining the actor's action space.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">random_agent</span><span class="p">(</span><span class="n">actor_session</span><span class="p">):</span>
    <span class="n">actor_session</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">actor_session</span><span class="o">.</span><span class="n">event_loop</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">observation</span><span class="p">:</span>
            <span class="n">observation</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">observation</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">actor_session</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; received an observation: &#39;</span><span class="si">{</span><span class="n">observation</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">cogment</span><span class="o">.</span><span class="n">EventType</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">PlayerAction</span><span class="p">()</span>
                <span class="n">actor_session</span><span class="o">.</span><span class="n">do_action</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">reward</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">rewards</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">actor_session</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; received a reward for tick #</span><span class="si">{</span><span class="n">reward</span><span class="o">.</span><span class="n">tick_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">reward</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">messages</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">actor_session</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; received a message from &#39;</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">sender_name</span><span class="si">}</span><span class="s2">&#39;: - &#39;</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Our goal is to implement an actor playing at random. We first need to import the different <code>Move</code>, as defined in our data structures. We also need to import <code>random</code>, the python package generating random numbers.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">data_pb2</span> <span class="kn">import</span> <span class="n">ROCK</span><span class="p">,</span> <span class="n">PAPER</span><span class="p">,</span> <span class="n">SCISSORS</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="n">MOVES</span> <span class="o">=</span> <span class="p">[</span><span class="n">ROCK</span><span class="p">,</span> <span class="n">PAPER</span><span class="p">,</span> <span class="n">SCISSORS</span><span class="p">]</span>
<span class="n">MOVES_STR</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;👊 rock&quot;</span><span class="p">,</span> <span class="s2">&quot;✋ paper&quot;</span><span class="p">,</span> <span class="s2">&quot;✌️ scissors&quot;</span><span class="p">]</span>
</code></pre></div>

<p>Once this is available we can simply update the <em>taking decision</em> part of the actor's implementation to compute a random move whenever it is needed.</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">observation</span><span class="p">:</span>
    <span class="n">observation</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">observation</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">actor_session</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; received an observation: &#39;</span><span class="si">{</span><span class="n">observation</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">cogment</span><span class="o">.</span><span class="n">EventType</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">:</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">PlayerAction</span><span class="p">(</span><span class="n">move</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">MOVES</span><span class="p">))</span>
        <span class="n">actor_session</span><span class="o">.</span><span class="n">do_action</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</code></pre></div>

<p>Modify the <code>random_agent/main.py</code> file to include the above additions.</p>
<h2 id="implementing-the-rules-of-the-game">Implementing the rules of the game<a class="headerlink" href="#implementing-the-rules-of-the-game" title="Permanent link">&para;</a></h2>
<p>In the <code>rps</code> directory, the <code>environment</code> directory contains the python implementation for the eponymous service. Similarly to the actor's service, you will find two files here, <code>requirements.txt</code> and <code>main.py</code>.</p>
<p>Open <code>main.py</code> and take a look at the generated content.</p>
<p>The code is very similar to the <code>random_agent</code>'s. In the <code>main</code> function, instead of using <code>register_actor</code>, <code>register_environment</code> is used. The implementation function, called <code>environment</code> here, is structured similarly to the actor's one but handles two kinds of events: <strong>actions</strong> (and the last actions of a trial <strong>final_actions</strong>) and <strong>message</strong>. Environments don't perform actions, they produce observations that are sent to the actors participating in the trial.</p>
<p>Please note the import and usage of <code>Observation</code> which is the datastructure defined in <code>data.proto</code> defining the actors observation space.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">environment</span><span class="p">(</span><span class="n">environment_session</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;environment starting&quot;</span><span class="p">)</span>
    <span class="c1"># Create the initial observaton</span>
    <span class="n">observation</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>

    <span class="c1"># Start the trial and send that observation to all actors</span>
    <span class="n">environment_session</span><span class="o">.</span><span class="n">start</span><span class="p">([(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">observation</span><span class="p">)])</span>

    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">environment_session</span><span class="o">.</span><span class="n">event_loop</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">actions</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;environment received the actions&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">actor</span><span class="p">,</span> <span class="n">recv_action</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">environment_session</span><span class="o">.</span><span class="n">get_active_actors</span><span class="p">(),</span> <span class="n">actions</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; actor &#39;</span><span class="si">{</span><span class="n">actor</span><span class="o">.</span><span class="n">actor_name</span><span class="si">}</span><span class="s2">&#39; did action &#39;</span><span class="si">{</span><span class="n">recv_action</span><span class="o">.</span><span class="n">action</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="n">observation</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">cogment</span><span class="o">.</span><span class="n">EventType</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">:</span>
                <span class="c1"># The trial is active</span>
                <span class="n">environment_session</span><span class="o">.</span><span class="n">produce_observations</span><span class="p">([(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">observation</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># The trial termination has been requested</span>
                <span class="n">environment_session</span><span class="o">.</span><span class="n">end</span><span class="p">([(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">observation</span><span class="p">)])</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">messages</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;environment received a message from &#39;</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">sender_name</span><span class="si">}</span><span class="s2">&#39;: - &#39;</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;environment end&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Our goal, in this section, is to implement how the environment computes the observations from the actions done by the actors at a given timestep.</p>
<p>We first import the needed datastructure and define a dictionary mapping each move to the move that defeats it.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">data_pb2</span> <span class="kn">import</span> <span class="n">PlayerState</span><span class="p">,</span> <span class="n">ROCK</span><span class="p">,</span> <span class="n">PAPER</span><span class="p">,</span> <span class="n">SCISSORS</span>

<span class="n">DEFEATS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">ROCK</span><span class="p">:</span> <span class="n">PAPER</span><span class="p">,</span>
  <span class="n">SCISSORS</span><span class="p">:</span> <span class="n">ROCK</span><span class="p">,</span>
  <span class="n">PAPER</span><span class="p">:</span> <span class="n">SCISSORS</span>
<span class="p">}</span>
</code></pre></div>

<p>In the <strong>initialization</strong> phase of the environment implementation, i.e. before the <code>async for</code>, we create a simple <code>state</code> data structure that is keeping around the number of rounds played and won by each of the two players.</p>
<p>We then compute the initial observation for each of the two players. One instance of <code>PlayerState</code> per player is created, each is used as the <code>me</code> and <code>them</code> state of each player's observation.</p>
<div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;rounds_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;p1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;won_rounds_count&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="s2">&quot;p2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;won_rounds_count&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;environment starting&quot;</span><span class="p">)</span>
<span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span> <span class="o">=</span> <span class="n">environment_session</span><span class="o">.</span><span class="n">get_active_actors</span><span class="p">()</span>
<span class="n">p1_state</span> <span class="o">=</span> <span class="n">PlayerState</span><span class="p">(</span><span class="n">won_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">last_move</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">p2_state</span> <span class="o">=</span> <span class="n">PlayerState</span><span class="p">(</span><span class="n">won_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">last_move</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">environment_session</span><span class="o">.</span><span class="n">start</span><span class="p">([</span>
    <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">actor_name</span><span class="p">,</span> <span class="n">Observation</span><span class="p">(</span><span class="n">me</span><span class="o">=</span><span class="n">p1_state</span><span class="p">,</span> <span class="n">them</span><span class="o">=</span><span class="n">p2_state</span><span class="p">)),</span>
    <span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">actor_name</span><span class="p">,</span> <span class="n">Observation</span><span class="p">(</span><span class="n">me</span><span class="o">=</span><span class="n">p2_state</span><span class="p">,</span> <span class="n">them</span><span class="o">=</span><span class="n">p1_state</span><span class="p">)),</span>
<span class="p">])</span>
</code></pre></div>

<p>In the <strong>event loop</strong> we implement how the environment produces observations based on the actor's actions.</p>
<p>We start by retrieving each player's action and computing who won the round. Then, we update the internal <code>state</code>. Finally, we produce up-to-date observations for the players.</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
    <span class="p">[</span><span class="n">p1_action</span><span class="p">,</span> <span class="n">p2_action</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">recv_action</span><span class="o">.</span><span class="n">action</span> <span class="k">for</span> <span class="n">recv_action</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p1</span><span class="o">.</span><span class="n">actor_name</span><span class="si">}</span><span class="s2"> played </span><span class="si">{</span><span class="n">MOVES_STR</span><span class="p">[</span><span class="n">p1_action</span><span class="o">.</span><span class="n">move</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p2</span><span class="o">.</span><span class="n">actor_name</span><span class="si">}</span><span class="s2"> played </span><span class="si">{</span><span class="n">MOVES_STR</span><span class="p">[</span><span class="n">p2_action</span><span class="o">.</span><span class="n">move</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Compute who wins, if the two players had the same move, nobody wins</span>
    <span class="n">p1_state</span> <span class="o">=</span> <span class="n">PlayerState</span><span class="p">(</span>
        <span class="n">won_last</span><span class="o">=</span><span class="n">p1_action</span><span class="o">.</span><span class="n">move</span> <span class="o">==</span> <span class="n">DEFEATS</span><span class="p">[</span><span class="n">p2_action</span><span class="o">.</span><span class="n">move</span><span class="p">],</span>
        <span class="n">last_move</span><span class="o">=</span><span class="n">p1_action</span><span class="o">.</span><span class="n">move</span>
    <span class="p">)</span>
    <span class="n">p2_state</span> <span class="o">=</span> <span class="n">PlayerState</span><span class="p">(</span>
        <span class="n">won_last</span><span class="o">=</span><span class="n">p2_action</span><span class="o">.</span><span class="n">move</span> <span class="o">==</span> <span class="n">DEFEATS</span><span class="p">[</span><span class="n">p1_action</span><span class="o">.</span><span class="n">move</span><span class="p">],</span>
        <span class="n">last_move</span><span class="o">=</span><span class="n">p2_action</span><span class="o">.</span><span class="n">move</span>
    <span class="p">)</span>
    <span class="n">state</span><span class="p">[</span><span class="s2">&quot;rounds_count&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">p1_state</span><span class="o">.</span><span class="n">won_last</span><span class="p">:</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;p1&quot;</span><span class="p">][</span><span class="s2">&quot;won_rounds_count&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p1</span><span class="o">.</span><span class="n">actor_name</span><span class="si">}</span><span class="s2"> wins!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">p2_state</span><span class="o">.</span><span class="n">won_last</span><span class="p">:</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;p2&quot;</span><span class="p">][</span><span class="s2">&quot;won_rounds_count&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p2</span><span class="o">.</span><span class="n">actor_name</span><span class="si">}</span><span class="s2"> wins!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;draw.&quot;</span><span class="p">)</span>

    <span class="c1"># Generate and send observations</span>
    <span class="n">observations</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">actor_name</span><span class="p">,</span> <span class="n">Observation</span><span class="p">(</span><span class="n">me</span><span class="o">=</span><span class="n">p1_state</span><span class="p">,</span> <span class="n">them</span><span class="o">=</span><span class="n">p2_state</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">actor_name</span><span class="p">,</span> <span class="n">Observation</span><span class="p">(</span><span class="n">me</span><span class="o">=</span><span class="n">p2_state</span><span class="p">,</span> <span class="n">them</span><span class="o">=</span><span class="n">p1_state</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">cogment</span><span class="o">.</span><span class="n">EventType</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">:</span>
        <span class="c1"># The trial is active</span>
        <span class="n">environment_session</span><span class="o">.</span><span class="n">produce_observations</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The trial termination has been requested</span>
        <span class="n">environment_session</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
</code></pre></div>

<p>Finally, in the <strong>termination</strong> phase, we print some stats about the trial itself.</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;environment end&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> * </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;rounds_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rounds played&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> * </span><span class="si">{</span><span class="n">p1</span><span class="o">.</span><span class="n">actor_name</span><span class="si">}</span><span class="s2"> won </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">][</span><span class="s1">&#39;won_rounds_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rounds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> * </span><span class="si">{</span><span class="n">p1</span><span class="o">.</span><span class="n">actor_name</span><span class="si">}</span><span class="s2"> won </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">][</span><span class="s1">&#39;won_rounds_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> rounds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> * </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;rounds_count&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">][</span><span class="s1">&#39;won_rounds_count&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">][</span><span class="s1">&#39;won_rounds_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> draws&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Modify the <code>environment/main.py</code> file to include the above additions. Please note that this code makes assumptions on the number of actors and their classes. Production code should handle non-standard cases in a better way.</p>
<p>You can now <a href="../1-bootstrap-and-data-structures/#building-and-running-the-app">build and run</a> the application. Given the nature of the game and the fully random nature of the plays you should have around 1/3 of player 1 wins, 1/3 of player 2's and 1/3 of draws.</p>
<p>This concludes the step 2 of the tutorial: you implemented your first actor and your first environment.</p>
<p>Let’s move on to learning more about rewards in <a href="../3-rewards/">step 3</a>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../1-bootstrap-and-data-structures/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Step 1: Bootstrap a Cogment app
            </div>
          </div>
        </a>
      
      
        <a href="../3-rewards/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Step 3: Introduce rewards
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2021 AI Redefined Inc. <dev+cogment@ai-r.com>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/cogment" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/AI_Redefined" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/ai-r" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
    
  </body>
</html>