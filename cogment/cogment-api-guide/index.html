
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Cogment user documentation - Cogment is an innovative open source AI platform designed to leverage the advent of AI to benefit humankind through human-AI collaboration">
      
      
      
        <meta name="author" content="AI Redefined">
      
      
        <link rel="canonical" href="https://docs.cogment.ai/cogment/cogment-api-guide/">
      
      <link rel="icon" href="../../images/cogment_favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.2">
    
    
      
        <title>API Guide - Cogment User Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.24c991ad.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../style/theme.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/github.min.css">
    
    
      
  



  
  



  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-146998765-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cogment-high-level-api-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cogment User Documentation" class="md-header__button md-logo" aria-label="Cogment User Documentation" data-md-component="logo">
      
  <img src="../../images/cogment_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cogment User Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Guide
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/cogment/cogment-doc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cogment User Documentation" class="md-nav__button md-logo" aria-label="Cogment User Documentation" data-md-component="logo">
      
  <img src="../../images/cogment_logo.png" alt="logo">

    </a>
    Cogment User Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/cogment/cogment-doc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/installation/" class="md-nav__link">
        Installation & Setup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Support
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Support" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Support
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../support/community-channels/" class="md-nav__link">
        Community channels
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concepts" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/core-concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Cogment APIs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cogment APIs" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Cogment APIs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/1-bootstrap-and-data-structures/" class="md-nav__link">
        Step 1: Bootstrap a Cogment app
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/2-random-player/" class="md-nav__link">
        Step 2: Implement actor and environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/3-rewards/" class="md-nav__link">
        Step 3: Introduce rewards
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/4-heuristic-player/" class="md-nav__link">
        Step 4: Create a heuristic player
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/5-human-player/" class="md-nav__link">
        Step 5: Add a human player in the loop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/6-web-client/" class="md-nav__link">
        Step 6: Implement a web client for the human player
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/7-dqn-player/" class="md-nav__link">
        Step 7: Add a player trained with Reinforcement Learning using DQN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          API Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        API Guide
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-spec-file" class="md-nav__link">
    The spec file
  </a>
  
    <nav class="md-nav" aria-label="The spec file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compiling-the-spec-file" class="md-nav__link">
    Compiling the spec file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    Environment
  </a>
  
    <nav class="md-nav" aria-label="Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sending-observations" class="md-nav__link">
    Sending observations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actor" class="md-nav__link">
    Actor
  </a>
  
    <nav class="md-nav" aria-label="Actor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-actor-client-actor" class="md-nav__link">
    Service actor / Client actor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controller" class="md-nav__link">
    Controller
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rewards" class="md-nav__link">
    Rewards
  </a>
  
    <nav class="md-nav" aria-label="Rewards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating" class="md-nav__link">
    Creating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consuming" class="md-nav__link">
    Consuming
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messages" class="md-nav__link">
    Messages
  </a>
  
    <nav class="md-nav" aria-label="Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating_1" class="md-nav__link">
    Creating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consuming_1" class="md-nav__link">
    Consuming
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-trial-hook" class="md-nav__link">
    Pre-trial hook
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/cogment-yaml/" class="md-nav__link">
        Spec file (cogment.yaml)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/parameters/" class="md-nav__link">
        Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../orchestrator/" class="md-nav__link">
        Orchestrator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/python/" class="md-nav__link">
        python SDK
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_5" type="checkbox" id="__nav_4_3_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_5">
          Javascript/Typescript SDK
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Javascript/Typescript SDK" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_5">
          <span class="md-nav__icon md-icon"></span>
          Javascript/Typescript SDK
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/modules.md" class="md-nav__link">
        Modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/classes/actorsession.md" class="md-nav__link">
        Class: ActorSession
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/classes/cogmentservice.md" class="md-nav__link">
        Class: CogmentService
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/classes/trialcontroller.md" class="md-nav__link">
        Class: TrialController
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/enums/eventtype.md" class="md-nav__link">
        Enum: EventType
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/cogmentyaml.md" class="md-nav__link">
        Interface: CogmentYaml
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/cogmentyamlactor.md" class="md-nav__link">
        Interface: CogmentYamlActor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/cogmentyamlactorclass.md" class="md-nav__link">
        Interface: CogmentYamlActorClass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/cogmentyamldatalog.md" class="md-nav__link">
        Interface: CogmentYamlDatalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/cogmentyamltrialparameters.md" class="md-nav__link">
        Interface: CogmentYamlTrialParameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/cogsettings.md" class="md-nav__link">
        Interface: CogSettings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/cogsettingsactorclass.md" class="md-nav__link">
        Interface: CogSettingsActorClass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/createserviceoptions.md" class="md-nav__link">
        Interface: CreateServiceOptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/event.md" class="md-nav__link">
        Interface: Event
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/reward.md" class="md-nav__link">
        Interface: Reward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/sendmessageoptions.md" class="md-nav__link">
        Interface: SendMessageOptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-api-reference/javascript/interfaces/trialactor.md" class="md-nav__link">
        Interface: TrialActor
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Low Level API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Low Level API Reference" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Low Level API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-low-level-api-guide/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cogment-low-level-api-guide/grpc/" class="md-nav__link">
        gRPC API Reference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../implementation-recipes/" class="md-nav__link">
        Implementation recipes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Cogment Components
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cogment Components" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cogment Components
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-components/cli/cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../orchestrator/" class="md-nav__link">
        Orchestrator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-components/model-registry/model-registry/" class="md-nav__link">
        Model Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-components/trial-datastore/trial-datastore/" class="md-nav__link">
        Trial Datastore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cogment-components/dashboard/metrics-and-dashboard/" class="md-nav__link">
        Metrics & Dashboard
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-spec-file" class="md-nav__link">
    The spec file
  </a>
  
    <nav class="md-nav" aria-label="The spec file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compiling-the-spec-file" class="md-nav__link">
    Compiling the spec file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    Environment
  </a>
  
    <nav class="md-nav" aria-label="Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sending-observations" class="md-nav__link">
    Sending observations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actor" class="md-nav__link">
    Actor
  </a>
  
    <nav class="md-nav" aria-label="Actor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-actor-client-actor" class="md-nav__link">
    Service actor / Client actor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controller" class="md-nav__link">
    Controller
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rewards" class="md-nav__link">
    Rewards
  </a>
  
    <nav class="md-nav" aria-label="Rewards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating" class="md-nav__link">
    Creating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consuming" class="md-nav__link">
    Consuming
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messages" class="md-nav__link">
    Messages
  </a>
  
    <nav class="md-nav" aria-label="Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating_1" class="md-nav__link">
    Creating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consuming_1" class="md-nav__link">
    Consuming
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-trial-hook" class="md-nav__link">
    Pre-trial hook
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cogment/cogment-doc/edit/main/src/cogment/cogment-api-guide.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="cogment-high-level-api-guide">Cogment High-Level API guide<a class="headerlink" href="#cogment-high-level-api-guide" title="Permanent link">&para;</a></h1>
<blockquote>
<p>NOTE: Some features aren't available in Javascript, if there's only python examples under a certain section, that feature is python only</p>
</blockquote>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>This document assumes the reader is familiar with the <a href="../../concepts/core-concepts/">Cogment Fundamentals</a>.</p>
<p>The High-level Cogment API expects users to use <a href="https://developers.google.com/protocol-buffers/" target="_blank">protocol buffers</a> to declare a project's data structures. The intricacies of protobufs are beyond the scope of this document. Basic knowledge of the technology and its usage is assumed.</p>
<h2 id="the-spec-file">The spec file<a class="headerlink" href="#the-spec-file" title="Permanent link">&para;</a></h2>
<p>An <a href="../../concepts/glossary/#actor-class">actor class</a> is primarily defined by its <a href="../concepts/glossary#observation-space">observation space</a> and <a href="../concepts/glossary#action-space">action space</a>.</p>
<p>The data structures describing these spaces are declared by using a protocol buffer message type. <a href="../../concepts/glossary/#observation">Observations</a> and <a href="../../concepts/glossary/#action">actions</a> will simply be instances of the matching type.</p>
<p>For example, in the following, <code>driver</code> and <code>pedestrian</code> share a common view of the environment, hence use the same observation space, but have different actions available to them.</p>
<pre class="highlight"><code class="language-yaml">import:
    proto:
        - city.proto

actors:
    driver:
        observation:
            space: city.Observation

        action:
            space: city.DriverAction

    pedestrian:
        observation:
            space: city.Observation

        action:
            space: city.PedestrianAction</code></pre>
<blockquote>
<p>⚠️ This shows only the relevant part of the full spec file, you can find the full list of configurable options <a href="../cogment-api-reference/cogment-yaml/">in the reference page</a>.</p>
</blockquote>
<h3 id="compiling-the-spec-file">Compiling the spec file<a class="headerlink" href="#compiling-the-spec-file" title="Permanent link">&para;</a></h3>
<p>In order to use the spec file (typically named <code>cogment.yaml</code>) within the various supported languages, it needs to be compiled. This is done by the code generation modules of the specific language's SDK you are using. Refer to the language specific documentation for instructions</p>
<h2 id="environment">Environment<a class="headerlink" href="#environment" title="Permanent link">&para;</a></h2>
<p><a href="../../concepts/glossary/#environment">Environments</a> are implemented by a Python function that uses a <a href="../cogment-api-reference/python/#class-environmentsessionsession"><code>cogment.EnvironmentSession</code></a> instance.</p>
<p>This function will be called once for each <a href="../../concepts/glossary/#trial">trial</a>. This function usually consists of three sections.</p>
<ul>
<li>The environment's <strong>initialization</strong>, where its internal state can be initialized and processes started. It ends with the sending of the initial observations to the actors participating in the trial.</li>
<li>Its <strong>event loop</strong>, where the environment iterates through the events occurring during the trial and produces <a href="../../concepts/glossary/#observation">observations</a> as well as receives <a href="../../concepts/glossary/#message">messages</a>. In this loop the environment can end the trial on its own or the end can be requested by a <a href="#controller">controller</a>.</li>
<li>Its <strong>termination</strong>, where cleanup occurs.</li>
</ul>
<p>In the common case where all actors within a trial share the same observation, a bare-minimum environment service would look like this:</p>
<pre class="highlight"><code class="language-python">async def environment(environment_session):
    # -- Initialization --

    # Retrieve the actors participating in the trial
    actors = environment_session.get_active_actors()

    # Start the trial and send a starting observation to all actors
    environment_session.start([("*", Observation())])

    # -- Event loop --
    async for event in environment_session.event_loop():
        if event.actions:
            # `event.actions` is a list of the actions done by the actors
            actions = event.actions
            if event.type == cogment.EventType.ACTIVE:
              # The trial is active, produce an observation in response to the actions
              environment_session.produce_observations([("*", Observation())])
              # Alternatively the environment can decide to **end** the trial with the following
              # environment_session.end([("*", Observation())])
            else:
              # The trial termination has been requested by an external controller
              # Produce a final observation
              environment_session.end([("*", Observation())])

        for message in event.messages:
            # `event.messages` is a list of all the messages received by the environment (it can be empty)

            # Handle each message here.

    # -- Termination --</code></pre>
<p>This environment implementation needs to be registered and served so that the <a href="../../concepts/glossary/#orchestrator">orchestrator</a> can reach it. This can be done through a <a href="../cogment-api-reference/python/#class-cogmentcontext"><code>Context</code></a> instance.</p>
<pre class="highlight"><code class="language-python">context = cogment.Context(user_id="my_user_id", cog_settings=cog_settings)

context.register_environment(impl=environment)

await context.serve_all_registered(cogment.ServedEndpoint(port=9000))</code></pre>
<h3 id="sending-observations">Sending observations<a class="headerlink" href="#sending-observations" title="Permanent link">&para;</a></h3>
<p>The environment session has 3 different methods able to send observations: <code>start</code>, <code>produce_observations</code> and <code>end</code>. Each of those methods takes a list of 2-tuples destination / observation.</p>
<p>As demonstrated above, sending the same observation to all actors is done using <code>"*"</code> as the destination.</p>
<pre class="highlight"><code class="language-python">environment_session.produce_observations([("*", Observation(...))])</code></pre>
<p>It is also possible to send different observations to different actors. This can be useful to send observations of the <em>world</em> from the point of view of the actor or to send partial observations.</p>
<pre class="highlight"><code class="language-python">environment_session.produce_observations([
  ("my_first_actor_name", Observation(...)),
  ("my_second_actor_name", Observation(...))
])</code></pre>
<p>Please note that the environment should always send observations such as each actor in the trial receives one.</p>
<h2 id="actor">Actor<a class="headerlink" href="#actor" title="Permanent link">&para;</a></h2>
<p><a href="../../concepts/glossary/#actor">Actors</a> implementations look a lot like the <a href="#environment">environment's</a>. They take a <a href="../cogment-api-reference/python/#class-actorsessionsession"><code>cogment.ActorSession</code></a> instance and have the same three sections: <strong>initialization</strong>, <strong>event loop</strong> and <strong>termination</strong>.</p>
<p>The event loops in Actors' implementations handle three basic types of events:</p>
<ul>
<li><code>observation</code> produced by the environment and that should lead to an action being done.</li>
<li><code>rewards</code> sent by other actors or the environment, we'll talk about them in more details <a href="#reward">below</a>.</li>
<li><code>messages</code> sent by other actors or the environment, we'll talk about them in more details <a href="#messages">below</a>.</li>
</ul>
<p>A typical actor implementation would look like this:</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">async def driver_actor(actor_session):
    # -- Initialization --

    # Notify that the actor is ready for the trial to start.
    actor_session.start()

    async for event in actor_session.event_loop():
        if event.observation:
            # `event.observation` is an instance of the Observation produced by the environment
            observation = event.observation
            if event.type == cogment.EventType.ACTIVE:
            # The trial is active, it is expecting the agent to do an action
            actor_session.do_action(DriverAction(...))

        for reward in event.rewards:
            # `event.rewards` is a list of all the rewards received by the actor (it can be empty)

            # Handle each reward here.

        for message in event.messages:
            # `event.messages` is a list of all the messages received by the actor (it can be empty)

            # Handle each message here.</code></pre>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-javascript">const driverActor = async (actorSession) =&gt; {
    // -- Initialization --

    // Notify that the actor is ready for the trial to start.
    actorSession.start();

    for await (const event of actorSession.eventLoop()) {
        if (event.observation){
            // `event.observation` is an instance of the Observation produced by the environment
            observation = event.observation
            if event.type == cogment.EventType.ACTIVE:
            // The trial is active, it is expecting the agent to do an action
            actorSession.sendAction(new DriverAction())
        }


        for (const reward of event.rewards){
            // `event.rewards` is a list of all the rewards received by the actor (it can be empty)

            // Handle each reward here.
        }

        for (const message of event.messages){
            // `event.messages` is a list of all the messages received by the actor (it can be empty)

            // Handle each message here.
        }
    }
}</code></pre>
</div>
</div>
<h3 id="service-actor-client-actor">Service actor / Client actor<a class="headerlink" href="#service-actor-client-actor" title="Permanent link">&para;</a></h3>
<p>A Cogment app can use two types of actors, they are identical in terms of implementation but differ in how they interact with the app's <a href="../../concepts/glossary/#orchestrator">Orchestrator</a>.</p>
<p><strong>Service actors</strong> are accessible in the same way the environment is, through a <a href="../cogment-api-reference/python/#class-cogmentcontext"><code>Context</code></a> instance.</p>
<pre class="highlight"><code class="language-python">context = cogment.Context(cog_settings=cog_settings, user_id="rps")
context.register_actor(impl=actor, impl_name="driver_actor", actor_classes=["driver"])
context.register_actor(impl=actor_slow, impl_name="driver_actor_slow", actor_classes=["driver"])

await context.serve_all_registered(cogment.ServedEndpoint(port=9000))</code></pre>
<p>Note that it is also through this registrating that the implementation is associated with one or more <a href="../../concepts/glossary/#actor-class">actor classes</a> it implements.</p>
<p><strong>Client actors</strong>, contrary to Service actors, are not served to the <a href="../../concepts/glossary/#orchestrator">orchestrator</a>. They connect as clients of the orchestrator and join a <a href="../../concepts/glossary/#trial">trial</a> that has started.</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">context = cogment.Context(cog_settings=cog_settings, user_id="rps")
context.register_actor(impl=actor, impl_name="driver_actor", actor_classes=["driver"])

await context.join_trial(trial_id=trial_id, cogment.Endpoint(url="grpc://orchestrator:9000"), actor_name="Alice")</code></pre>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-javascript">const grpcURL = "http://someGrpcWebProxyEndpoint:port"

const service = cogment.createService({
    cogSettings,
    grpcURL,
});

const actor = { name: actorName, actorClass: actorClass };

service.registerActor(
    actor,
    actorImpl
)

const trialController = service.createTrialController();

trialController.joinTrial(trialId, actor);</code></pre>
</div>
</div>
<p>Note that a trial including one or more client actors will wait for all of them to join before any actor can start processing events.</p>
<p>Due to the different network requirements, client actors are a good fit when implementing a <a href="../../concepts/glossary/#frontend">frontend</a> for human actors. In addition to the <a href="../cogment-api-reference/python/">python</a> SDK demonstrated above, client actors can be implemented in <a href="./cogment-api-reference/javascript/modules.md">javascript</a> using the corresponding SDK.</p>
<h2 id="controller">Controller<a class="headerlink" href="#controller" title="Permanent link">&para;</a></h2>
<p><a href="../../concepts/glossary/#trial">Trials</a> are started by clients of the <a href="../../concepts/glossary/#orchestrator">Orchestrator</a> using a Controller. Instances of a controller are built from the <a href="../cogment-api-reference/python/#class-cogmentcontext"><code>Context</code></a> instance and connect to an Orchestrator endpoint.</p>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">controller = context.get_controller(endpoint=cogment.Endpoint(url="grpc://orchestrator:9000"))</code></pre>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-javascript">
const service = cogment.createService({
    cogSettings,
    "grpc://orchestrator:9000",
});

const trialController = service.createTrialController();</code></pre>
</div>
</div>
<p>The controller can then be used to create trials and request their termination.</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">trial_id = await controller.start_trial(trial_config=TrialConfig())

# ...

await controller.terminate_trial(trial_id)</code></pre>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-javascript">const {trialId} = await trialController.startTrial(someActorClass, new TrialConfig());

// ...

await trialControler.terminateTrial(trialId)</code></pre>
</div>
</div>
<p>The controller can also be used to subscribe to events occuring in the trials run by the Orchestrator it connects to. For example, this can be used to wait for a trial's end:</p>
<div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">async for trial_info in controller.watch_trials(trial_state_filters=[cogment.TrialState.ENDED]):
    # The trial having id {trial_info.trial_id} ended.</code></pre>
</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-javascript">for await (const trialListEntry of trialController.watchTrials([
  cogment.TrialState.ENDED
])) {
  // The trial having id {trialListEntry.getTrialId()} ended.
}</code></pre>
</div>
</div>
<p>The full documentation for the controller can be found <a href="../cogment-api-reference/python/#class-controller">here</a>.</p>
<h2 id="rewards">Rewards<a class="headerlink" href="#rewards" title="Permanent link">&para;</a></h2>
<h3 id="creating">Creating<a class="headerlink" href="#creating" title="Permanent link">&para;</a></h3>
<p><a href="../../concepts/glossary/#reward">Rewards</a> are sent to <a href="../../concepts/glossary/#actor">actors</a> from another actor or the <a href="../../concepts/glossary/#environment">environment</a>. The <code>session</code> instance passed to their implementation can be used for this purpose.</p>
<pre class="highlight"><code class="language-python">session.add_reward(value=-1, confidence=1, tick_id=-1, to=['an_actor_name'])</code></pre>
<p>Rewards consist of an arbitrary numerical <strong>value</strong> describing how the reward "sender" <em>believes</em> the actor performed. It is <em>weighted</em> by a value between 0 and 1 qualifying the <strong>confidence</strong> of the "sender" in its reward, from a very low confidence just above 0 to a very high confidence approaching 1. The confidence value is used to collate all the rewards sent to an actor at the same time. Optionally, a reward can be provided with arbitrary user data.</p>
<p>Each reward applies to a list of recipients (either all the actors, all the actors of a given class or a specific actor) at a specific point in time, during the trial, defined as a <a href="../../concepts/glossary/#tick"><strong>tick</strong></a>.</p>
<p>The full documentation for <code>session.add_reward</code> can be found <a href="../cogment-api-reference/python/#add_rewardself-value-confidence-to-tick_id-1-user_datanone">here</a>.</p>
<h3 id="consuming">Consuming<a class="headerlink" href="#consuming" title="Permanent link">&para;</a></h3>
<p>All the <a href="../../concepts/glossary/#reward">rewards</a> that are sent and destined to each specific <a href="../../concepts/glossary/#actor">actor</a> for a given point in time are collated together by the framework.</p>
<p>The <a href="../../concepts/glossary/#actor">actor</a> can take into account the reward directly as the <a href="../../concepts/glossary/#trial">trial</a> is running by consuming the <code>"reward"</code> event in their event loop.</p>
<div class="tabbed-set" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">async for event in actor_session.event_loop():
    # [...]
    for reward in event.rewards:
        # `reward.tick_id` is the id of the tick this reward concerns.
        tick_id = reward.tick_id
        # `reward.value` is the aggregated value of the reward.
        value = reward.value
        for source_reward in reward.all_sources():
            # Iterate over individual source rewards.
            reward_value = source_reward.value
            reward_confidence = source_reward.confidence
            reward_sender = source_reward.sender
            reward_user_data = source_reward.user_data</code></pre>
</div>
<input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><label for="__tabbed_6_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-javascript">for await (const event of actorSession.eventLoop()) {
    // [...]
    for (const reward of event.rewards){
        // `reward.tickId` is the id of the tick this reward concerns.
        const tickId = reward.tickId
        // `reward.value` is the aggregated value of the reward.
        const value = reward.value
        for (sourceReward of reward.sourcesList) {
            // Iterate over individual source rewards.
            const rewardValue = sourceReward.value
            const rewardConfidence = sourceReward.confidence
            const rewardSender = sourceReward.senderName
            const rewardUserData = sourceReward.userData
        }
    }
}</code></pre>
</div>
</div>
<h2 id="messages">Messages<a class="headerlink" href="#messages" title="Permanent link">&para;</a></h2>
<h3 id="creating_1">Creating<a class="headerlink" href="#creating_1" title="Permanent link">&para;</a></h3>
<p><a href="../../concepts/glossary/#message">Messages</a> can be created and sent between <a href="../../concepts/glossary/#actor">actors</a> or the <a href="../../concepts/glossary/#environment">environment</a> within a trial using their <code>session</code> instance.</p>
<div class="tabbed-set" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">session.send_message(
    user_data=MyProtobufDataStructure(...), # any protobuf data structure can be used here.
    to=['pedestrian:*'], # send the message to all the actors of the "pedestrian" class
)</code></pre>
</div>
<input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><label for="__tabbed_7_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-Javascript">const message = new Message();
message.setRequest("hello");

// Now we serialize into an Any protobuf message.
const anyPb = new MyProtobufDataStructure();
anyPb.pack(message.serializeBinary(), 'cogment_app.Message');

actorSession.sendMessage({
    from: actorName,
    payload: anyPb,
    to: 'otherActorName',
    trialId,
});</code></pre>
</div>
</div>
<p>Messages consist of an arbitrary payload, their <code>user_data/payload</code>, defined as an instance of any protobuf data structure.</p>
<p>A message can be sent to one, many or all actors in a trial and / or to the environment.</p>
<p>The full documentation for <code>session.send_message</code> can be found <a href="../cogment-api-reference/python/#send_messageself-payload-to-to_environmentfalse">here</a>.</p>
<h3 id="consuming_1">Consuming<a class="headerlink" href="#consuming_1" title="Permanent link">&para;</a></h3>
<p>All the <a href="../../concepts/glossary/#message">messages</a> that are sent and intended for each specific actor or environment will be received by the target actor or environment.</p>
<p>Actors or the environment can use the message directly, live, as the <a href="../../concepts/glossary/#message">trial</a> is running by consuming message event in their event loop.</p>
<div class="tabbed-set" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><label for="__tabbed_8_1">Python</label><div class="tabbed-content">
<pre class="highlight"><code class="language-python">async for event in actor_session.event_loop():
    # [...]
    for message in event.messages:
        # `message.sender_name` is the name of the actor who sent a message
        sender_name = message.sender_name
        # `message.payload` is the content of the message, it needs to be unpacked
        payload = message.payload</code></pre>
</div>
<input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><label for="__tabbed_8_2">Javascript</label><div class="tabbed-content">
<pre class="highlight"><code class="language-javascript">for await (const event of actorSession.eventLoop()) {
    // [...]
    for (const message of event.messages){
        // `message.sender_name` is the name of the actor who sent a message
        const sender = message.sender
        // `message.data` is the content of the message, it needs to be unpacked
        const data = message.data

        const newMessage = data.unpack(
          (x: Uint8Array) =&gt; Message.deserializeBinary(x),
          'cogment_app.Message',
        );
    }
}</code></pre>
</div>
</div>
<h2 id="pre-trial-hook">Pre-trial hook<a class="headerlink" href="#pre-trial-hook" title="Permanent link">&para;</a></h2>
<p>When starting a trial from a controller an instance of the message type defined in <a href="../cogment-api-reference/cogment-yaml/#trial"><code>trial:config_type</code></a> can be provided. This instance is then passed to the registered <strong>Pre trial hooks</strong> when the Orcehstrator was started. The role of these hooks is to fully parametrize the trial based on the provided config. To achieve that, they can modify the default trial params defined in the <a href="../cogment-api-reference/parameters/">parameters</a> to specify the environment (i.e. its endpoint, implementation name &amp; configuration), the number and parameters of the participant actors (i.e. their name, class, endpoint, implementation name &amp; configuration) as well as additional parameters for the trial. The pre-trial hook can therefore be used to dynamically configure trials, to act as a service endpoint registry, or a load balancer.</p>
<p>Pre-trial hook implementations are registered in the same way the environment or actor implementation are and follow the same <em>session</em> pattern.</p>
<pre class="highlight"><code class="language-python">async def my_pre_trial_hook(pre_hook_session):
    # The trial config provided by the controller can be retrieved like that
    trial_config = pre_hook_session.trial_config
    # The trial params can be edited directly
    pre_hook_session.environment_config = # [...]
    pre_hook_session.environment_endpoint = "grpc://my_environment:9000"
    pre_hook_session.actors = [
        {
            "name": "my_first_actor_name",
            "actor_class": "driver",
            "endpoint": "grpc://driver:9000",
            "implementation": "driver_actor",
            "config": # [...],
        },
        {
            "name": "my_second_actor_name",
            "actor_class": "predestrian",
            "endpoint": "cogment://client",
            "config": # [...],
        },
    ]
    # And finally should be validated
    pre_hook_session.validate()

context.register_pre_trial_hook(impl=my_pre_trial_hook)</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../tutorial/7-dqn-player/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Step 7: Add a player trained with Reinforcement Learning using DQN" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Step 7: Add a player trained with Reinforcement Learning using DQN
            </div>
          </div>
        </a>
      
      
        
        <a href="../cogment-api-reference/cogment-yaml/" class="md-footer__link md-footer__link--next" aria-label="Next: Spec file (cogment.yaml)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Spec file (cogment.yaml)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2021 AI Redefined Inc. <dev+cogment@ai-r.com>
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/cogment" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/AI_Redefined" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/ai-r" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.bc35569b.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
      
        <script src="../../javascripts/highlight.js"></script>
      
    
  </body>
</html>